DATA COLLECTION: 

We monitored high-frequency light absorbance at multiple depths in Falling Creek Reservoir (FCR; Vinton, VA, USA) using a s::can Spectrolyser UV-Visible spectrophotometer (s::can Messtechnik GmbH, Vienna, Austria) coupled with a multiplexor pumping system ('MUX' from MultiplexÔ, LLC; for technical details on the multiplexor pumping system and the sensor setup, refer to Birgand et al. 2016). The MUX pumps water samples from seven monitoring depths (0.1, 1.6, 3.8, 5, 6.2, 8, and 9m) into a flow-through cuvette where the UV-vis absorbance spectra of the sample are measured by the spectrophotometer. The system collected measurements of light absorbance every 2.5 nm wavelengths from 200 nm to 732.5 nm (optical path length of 10 mm) approximately at an hourly time step. 

We took multiple steps to limit the influence of fouling of the internal components of the MUX system, due to precipitation of Fe in contact with oxygen in the measuring cuvette. Between each pump cycle, deionized water was flushed through the system. At the end of each pump sequence (one sample from each depth), dilute hydrochloric acid (5%) was automatically pumped through the system and allowed to sit in the flow-through cuvette for approximately 2 minutes. We also collected a reference measurement in air at the end of each cycle, which was useful in determining the extent of fouling. Despite these efforts, some fouling was still evident during certain time periods. Fouling was most pronounced in the lower wavelengths (200-250 nm) and therefore we removed values for wavelengths less than 250 nm before fitting PLSR models.

FCR is equipped with an engineered hypolimnetic oxygenation system (for full details see Gerling et al. 2014) which can be activated to increase hypolimnetic dissolved oxygen (DO) without altering reservoir stratification.

The data file ‘MUX_FP_TS.csv’ includes the raw time series of high-frequency absorbance spectra collected during two deployments: the first deployment captured the natural oxygenation and mixing processes that occurred during reservoir turnover and lasted from 16 October to 9 November 2020.  During this time period the HOx system was on, so the hypolimnion was oxic before turnover, but the reservoir was thermally stratified. The second deployment was conducted between 26 May and 21 June 2021, excluding 11:00 EDT 31 May 2021 until 14:30 EDT 4 June 2021 when the MUX was not collecting data due to technical issues. The HOx system was initiated on 11 June 2021 at 11:00 EDT. This deployment captured the engineered oxygenation and mixing processes resulting from the initiation of HOx operation. The reservoir was thermally-stratified and the hypolimnion was anoxic (DO < 1 mg/L) prior to HOx operation and thus, while HOx operation added oxygen to the hypolimnion, we observed a limited increase in DO concentrations due to high chemical oxygen demand. The HOx system induced internal mixing within the hypolimnion, but the overall thermal stratification of the reservoir was not affected.

The transition from Eastern Daylight Savings Time (EDT) to Eastern Standard Time (EST) occurred during the first monitoring deployment at 2020-11-02 02:00:00. Timestamps for all MUX data, including the raw time series of absorbance spectra and the predicted Fe and Mn concentrations, were set to EDT (GMT+4) for the entire data collection period. Timestamps for sampling data used to calibrate predictive models were set to the America/New_York time zone designation, which observes daylight savings time.

PARTIAL LEAST SQUARES REGRESSION (PLSR) MODELING: 

The R script ‘1_Overlaps.R’ includes code for aggregating and cleaning the time series of absorbance spectra from files generated by the s::can spectrophotometer into a single dataframe. It then prepares the data for calibrating PLSR models by matching the spectrophotometer measurements to sampling data based on the time and depth of measurement or sampling. The R script ‘2_PLSR_MUX_bootstrap.R’ is used to fit PLSR models and compute predictions of total and soluble Fe and Mn concentrations based on the correlation between absorbance spectra and sampling data. The Fe and Mn sampling dataset used for calibration, including methods for sample collection and analysis, can be found in Schreiber et al. (2022). Source functions required to run PLSR models are included in the R script ‘PLSR_MUX_functions.R.’ Individual steps in the PLSR modeling workflow are detailed in each script, but some general information is provided below.

Model building was conducted using the pls package (Mevik et al. 2020; R Core Team 2022). The pls package has a built-in function for determining the number of model components based on the root mean squared error of prediction (RMSEP) using 10-fold cross validation (Mevik et al. 2020). It has been suggested that the number of components should not exceed 10% of the total number of observations used to calibrate the model (Mevik et al. 2020). We followed this rule to the greatest extent possible. In some cases, the number of components slightly exceeded the 10% requirement, but this only occurred when including an additional component would substantially decrease the RMSEP determined by 10-fold cross validation, while also improving the variance explained by the model. 

Calibration datasets were assessed for potential outliers using an ensemble approach implemented in the R package enpls (Xiao et al. 2019). For each model, an ensemble of 50 PLSR sub-models was generated using Monte Carlo resampling and the empirical predictive error distribution for each sample was used to identify outliers. Samples with a mean predictive error greater than 3 standard deviations from the mean predictive error for all samples or with a standard deviation greater than 3 times the mean standard deviation of all samples were considered potential outliers (Cao et al. 2017). However, we took a conservative approach and did not eliminate all samples that met this criteria, but rather only removed samples that were identified not only as outliers by the aforementioned method but also led to a deterioration of model fit, showed signs of sampling/analytical error, or were collected during times of cuvette fouling. Details on the final sample size of calibration for each model can be found in Table 1 of the accompanying manuscript for this data package.

To assess the uncertainty of the predictions made using PLSR, we calculated nonparametric bootstrap predictive intervals following methods described by Denham (1997). Model skill was assessed using the coefficient of determination (R2) from the linear regression between predicted and observed values, as well as the root mean squared error of prediction (RMSEP) for each model (following Wold et al. 2001 and Mevik et al. 2020).

Separate PLSR models were developed for each deployment, variable (total Fe, soluble Fe, total Mn, and soluble Mn) and depth layer. Epilimnion models included data from 0.1, 1.6, and 3.8 m and hypolimnion models included data from 6.2, 8.0, and 9.0 m. Although we also collected data from 5.0 m, we did not include them in our analyses since this is at the transition between the two layers (metalimnion; see McClure et al. 2018) and thus not applicable to either layer. We developed separate models for the Turnover Deployment and the Oxygen On Deployment. In the end, we had four separate models for each of the four variables (total and soluble Fe and Mn), resulting in 16 different models. In some cases, PLSR predicted slightly negative concentration values. For the purposes of this analysis, we report the actual predicted values (including negative concentrations), but suggest that future users of this data package consider negative values to have a value of 0 mg/L for all variables. The data file ‘MUX_predictions_boot.csv’ contains the predicted time series of total and soluble Fe and Mn concentrations, with 90% predictive intervals, for the two deployment periods in this study. Note that these results are reflective of our particular modeling workflow, which involved the authors’ decision-making at multiple steps in the process (i.e., removing outliers, choosing the number of components) and therefore subsequent users of this data package may not obtain the exact same results unless they reproduce our process exactly. 

REFERENCES:

Birgand, F. et al. First report of a novel multiplexer pumping system coupled to a water quality probe to collect high temporal frequency in situ water chemistry measurements at multiple sites. Limnol. Oceanogr. Methods 14, 767–783 (2016).

Cao, D.S., Deng, Z.K., Zhu, M.F., Yao, Z.J., Dong, J., Zhao, R.G., 2017. Ensemble partial least squares regression for descriptor selection, outlier detection, applicability domain assessment, and ensemble modeling in QSAR/QSPR modeling. J. Chemom. 31, 1–17. https://doi.org/10.1002/cem.2922

Denham, M. C. Prediction intervals in partial least squares. J. Chemom. 11, 39–52 (1997).

Gerling, A.B., Browne, R.G., Gantzer, P.A., Mobley, M.H., Little, J.C., Carey, C.C., 2014. First report of the successful operation of a side stream supersaturation hypolimnetic oxygenation system in a eutrophic, shallow reservoir. Water Res. 67, 129–143. https://doi.org/10.1016/j.watres.2014.09.002

McClure, R. P. et al. Metalimnetic oxygen minima alter the vertical profiles of carbon dioxide and methane in a managed freshwater reservoir. Sci. Total Environ. 636, 610–620 (2018).

Mevik, B.H., Wehrens, R., and Liland, K.H. (2020). pls: Partial Least Squares and Principal Component Regression. R package version 2.7-3. https://CRAN.R-project.org/package=pls

R Core Team (2022). R: A language and environment for statistical computing. R Foundation for Statistical Computing, Vienna, Austria. URL https://www.R-project.org/.

Schreiber, M.E., N.W. Hammond, K.M. Krueger, Z.W. Munger, C.L. Ming, A. Breef-Pilz, and C.C. Carey. 2022. Time series of total and soluble iron and manganese concentrations from Falling Creek Reservoir and Beaverdam Reservoir in southwestern Virginia, USA from 2014 through 2021 ver 6. Environmental Data Initiative. https://doi.org/10.6073/pasta/7cdf3d7a234963b265f09b7d6d08f357.

Wold, S., Sjöström, M. & Eriksson, L. PLS-regression: A basic tool of chemometrics. Chemom. Intell. Lab. Syst. 58, 109–130 (2001).

Xiao, N., Cao, D.S., Li, M.Z., and Xu, Q.S. (2019). enpls: Ensemble Partial Least Squares Regression. R package version 6.1. https://CRAN.R-project.org/package=enpls

